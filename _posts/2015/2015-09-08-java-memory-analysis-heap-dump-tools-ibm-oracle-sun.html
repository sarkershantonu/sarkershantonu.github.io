---
layout: post
title: 'Offline Java Memory Analysis : Introduction to tools for Heap and Thread Dumps,
  GC log Analysis'
date: '2015-09-08T03:50:00.000+06:00'
author: Shantonu Sarker
tags:
- JAVA
- Java Language
- Performance Testing
modified_time: '2016-01-28T18:47:46.671+06:00'
thumbnail: http://lh3.googleusercontent.com/-UeHomHVBfMI/Ve4GUML0riI/AAAAAAAABig/gWqsdEUlBTA/s72-c/image_thumb%25255B16%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-2902524569242410076.post-1378736464633988264
blogger_orig_url: https://shantonusarker.blogspot.com/2015/09/java-memory-analysis-heap-dump-tools-ibm-oracle-sun.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">In this article we are going to see different tools which can be used for different Java Memory Analysis in offline. I will try to include all kinds of offline analysis tools. OS process memory monitoring and tools are ignored due to context.<br /><br /><b>What is offline analysis?</b><br />When we do analysis on recorded data , not live data, then it refers to offline analysis.<br /><br />For Java memory analysis, we will perform analysis on not&nbsp; live data but recorded. For Java memory analysis, we need mainly three type of information of JVM to get to bottom of it.<br /><b>1. Java Heap Dump : </b>This represents JVM heap memory information<br /><b>2. Java Core /Thread Dump:</b> This shows running thread state and conditions. The core contains more detail information. For IBM , core and thread dump are same. Different JVM may also include <b>trace</b> files here.<br /><b>3. GC logs :</b> This shows Garbage collection history in logs.<br /><br />I will not go detail on each one, lets see the tools only<br /><br /><b>For All IBM JVM</b> : You need to have IBM Support Assistant. This is a web distribution, you need to run this with Java and your PC will host all tools to gather. Here is the <b><a href="http://www-01.ibm.com/software/support/isa/teamserver.html" target="_blank">download link</a>.&nbsp; </b><b>How to setup IBM ISA?</b> Unzip and <b>run start_isa.bat</b> .<br />And in browser if you go to this link <a href="http://localhost:10911/isa5" title="http://localhost:10911/isa5">http://localhost:10911/isa5</a> You will be redirected here (all of this link &amp; ports are configurable)<br /><br /><div dir="ltr" style="text-align: left;" trbidi="on"></div><div dir="ltr" style="text-align: left;" trbidi="on"><a href="http://lh3.googleusercontent.com/-w2UPCZnI5z8/Ve4GTjb94hI/AAAAAAAABic/tm-na82Hz6Q/s1600-h/image%25255B30%25255D.png"><img alt="image" border="0" src="http://lh3.googleusercontent.com/-UeHomHVBfMI/Ve4GUML0riI/AAAAAAAABig/gWqsdEUlBTA/image_thumb%25255B16%25255D.png?imgmax=800" height="1197" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="image" width="505" /></a></div><div dir="ltr" style="text-align: left;" trbidi="on"><br />You will get 3 type of tools, JNLP web start, eclipse plugins link, web based. If you download and open the JNLP via notepad, you can actually configure JVM configuration. I used make a separate bat file to run JNLP with IBM JVM(non environment run time environment) </div><div dir="ltr" style="text-align: left;" trbidi="on"><br />Make sure, your PC donâ€™t have global log file as environment variable(if you install HP testing product you will have), Just delete that environment variable. ISA will create a variable path for log for it self and you can run this.</div><div dir="ltr" style="text-align: left;" trbidi="on"><br /><b>For all Oracle JVM :&nbsp;</b><br /><br />1. Java Mission Control(<b>JMC</b>), Comes free with JDK. But you need to install these tools as plugins.<br /><b>a. JOverflow / Heap Analysis</b><br /><b>b. DTrace Recorder</b><br /><b>c. Flight Recorder Plugins</b><br /><b>d. Console Plugins</b><br /><br /><a href="http://lh3.googleusercontent.com/-IBmN5cchjFY/Ve4GUaUSqLI/AAAAAAAABio/9TJGYJE0T5g/s1600-h/image%25255B16%25255D.png"><img alt="image" border="0" src="http://lh3.googleusercontent.com/-TSNcR70Pxmg/Ve4GU4NcgWI/AAAAAAAABiw/dIGx13UR0j4/image_thumb%25255B8%25255D.png?imgmax=800" height="274" style="background-image: none; border-color: -moz-use-text-color; border-style: none; border-width: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="image" width="396" />&nbsp;</a></div><div dir="ltr" style="text-align: left;" trbidi="on"></div><div dir="ltr" style="text-align: left;" trbidi="on"><br /><a href="http://lh3.googleusercontent.com/-Zb8dLgZvppQ/Ve4GVeHfpxI/AAAAAAAABi4/Bfy3obJQ9Qo/s1600-h/image%25255B20%25255D.png"><img alt="image" border="0" src="http://lh3.googleusercontent.com/-m2Sn6LXXeoQ/Ve4GWDhdfZI/AAAAAAAABjA/bPg445IR1mc/image_thumb%25255B10%25255D.png?imgmax=800" height="310" style="background-image: none; border-color: -moz-use-text-color; border-style: none; border-width: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="image" width="258" /></a></div><div dir="ltr" style="text-align: left;" trbidi="on"><br />2. <b>Visual VM </b>: Comes free with JDK. Download useful plugins to get best out of it.<br /><br /><a href="http://lh3.googleusercontent.com/-nvll3j6femY/Ve4GWtqkhbI/AAAAAAAABjI/FamgZrM2BBo/s1600-h/image%25255B12%25255D.png"><img alt="image" border="0" src="http://lh3.googleusercontent.com/-Wy4ZGbFr0uk/Ve4GXOWVoyI/AAAAAAAABjQ/K71vvG3bTy4/image_thumb%25255B6%25255D.png?imgmax=800" height="449" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="image" width="518" /></a><br /><br />Architecturally JMC based on eclipse &amp; Visual VM based on netbeans., so plugins installation process follows process of those IDE in installation (network config+ tools installations)<br /><br /></div><div dir="ltr" style="text-align: center;" trbidi="on"><span style="font-size: large;">Java Heap Analysis : </span></div><div dir="ltr" style="text-align: center;" trbidi="on"><span style="font-size: large;"><br /></span></div><div dir="ltr" style="text-align: left;" trbidi="on">1. <b>Eclipse MAT(including IBM IDDE)</b> supports IBM (phd)&amp; <b>Oracle </b>JVM heap dumps.<br /></div><div dir="ltr" style="text-align: justify;" trbidi="on"><a href="http://3.bp.blogspot.com/-5Zk5vxUogzQ/Ve3eqLO6vDI/AAAAAAAABhc/PZ8lpaylmlc/s1600/MAT.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="309" src="http://3.bp.blogspot.com/-5Zk5vxUogzQ/Ve3eqLO6vDI/AAAAAAAABhc/PZ8lpaylmlc/s320/MAT.jpg" width="320" /></a></div><div dir="ltr" style="text-align: left;" trbidi="on"><br />2. <b>Visual VM </b>: Oracle hprof format heap dump reader<br /><br />3. <b>JOverflow/Dump Analysis</b> as plugins of <b>Java Mission Control </b>:&nbsp; Oracle hprof format heap dump reader, provides <b>more details analysis than Visual VM.&nbsp;</b></div><div dir="ltr" style="text-align: left;" trbidi="on"><br /><br /><a href="http://lh3.googleusercontent.com/-Yrqv6ZxncoA/Ve4GXbBwTjI/AAAAAAAABjY/VI7ZK-oAwlo/s1600-h/image%25255B7%25255D.png"><img alt="image" border="0" src="http://lh3.googleusercontent.com/-TaAVuHXWGUU/Ve4GX_Q1jvI/AAAAAAAABjg/N4lrxT510mg/image_thumb%25255B3%25255D.png?imgmax=800" height="137" style="background-image: none; border-color: -moz-use-text-color; border-style: none; border-width: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="image" width="324" />&nbsp;</a></div><div dir="ltr" style="text-align: left;" trbidi="on"><br /><a href="http://lh3.googleusercontent.com/-7dXYv0wuQPc/Ve4GYRJSKlI/AAAAAAAABjo/D24CcufaPGQ/s1600-h/image%25255B3%25255D.png"><img alt="image" border="0" src="http://lh3.googleusercontent.com/-vwqLYYsaF2E/Ve4GZB6mCmI/AAAAAAAABjw/DChUYp3gKTI/image_thumb%25255B1%25255D.png?imgmax=800" height="428" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="image" width="656" /></a><br /><b><br /></b>4. <b>Heap Analyzer</b>(IBM Only) : IBM Phd format heap analyzer.<b> <a href="ftp://public.dhe.ibm.com/software/websphere/appserv/support/tools/HeapAnalyzer/ha456.jar" target="_blank">Download link</a>. </b><br /><b><br /></b></div><div class="separator" dir="ltr" style="clear: both; text-align: center;" trbidi="on"><a href="http://4.bp.blogspot.com/-esYFKUNdBXg/Ve3fVuqZDuI/AAAAAAAABhk/Y4DYLVuhZCI/s1600/HA.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/-esYFKUNdBXg/Ve3fVuqZDuI/AAAAAAAABhk/Y4DYLVuhZCI/s320/HA.jpg" width="154" /></a></div><div class="separator" dir="ltr" style="clear: both; text-align: center;" trbidi="on"><br /></div><div dir="ltr" style="text-align: left;" trbidi="on"><br /></div><div dir="ltr" style="text-align: center;" trbidi="on"><span style="font-size: large;">Thread Analysis :</span></div><div dir="ltr" style="text-align: left;" trbidi="on"><br /><b>For IBM JVM: (Java Core file and .trc file) </b></div><div dir="ltr" style="text-align: left;" trbidi="on"><b></b><br />1. <b>JCA </b>(Java Core analyzer) : This is from IBM support. <a href="ftp://public.dhe.ibm.com/software/websphere/appserv/support/tools/jca/jca457.jar" target="_blank"><b>Download</b> </a>and load text format java Core files.<br /><br /><a href="http://3.bp.blogspot.com/-HUXdkPCK3zM/Ve3f5PirzNI/AAAAAAAABhs/fb_osjE9Keg/s1600/JCA.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="320" src="http://3.bp.blogspot.com/-HUXdkPCK3zM/Ve3f5PirzNI/AAAAAAAABhs/fb_osjE9Keg/s320/JCA.jpg" width="272" /></a><br /><br />2.&nbsp; <b>GCMV</b>( Garbage collector Memory Visualizer) standalone or <b>GCMV Eclipse</b> Plugins , comes with ISA</div><div class="separator" dir="ltr" style="clear: both; text-align: center;" trbidi="on"><a href="http://2.bp.blogspot.com/-sQKseSALM2Y/Ve3iN30fDqI/AAAAAAAABiM/X0lryuc5rO8/s1600/GCMV-core.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="231" src="http://2.bp.blogspot.com/-sQKseSALM2Y/Ve3iN30fDqI/AAAAAAAABiM/X0lryuc5rO8/s320/GCMV-core.jpg" width="320" /></a></div><div dir="ltr" style="text-align: left;" trbidi="on"><br /><br />3. <b>Class Loader Analyzer </b>(IBM only) used for class loader analysis from java core and Snap&lt;&gt;.trc file. It comes with ISA.<br /><br />4. <b>Trace &amp; Request analyzer</b>(IBM only)&nbsp; used for reading Snap&lt;&gt;.trc files . <b><a href="ftp://public.dhe.ibm.com/software/websphere/appserv/support/tools/tra/tra302.jar" target="_blank">Download Link</a></b><br /><br />5. Thread &amp; Monitor Dump Analyzer (<b>TMDA</b>, IBM only)</div><div class="separator" dir="ltr" style="clear: both; text-align: center;" trbidi="on"><br /></div><div dir="ltr" style="text-align: left;" trbidi="on"><br />Note : .trc is trace file, you need to enable and configure to get proper information.<br /><br /><b>For Oracle JVM </b><br /><br />1. <b>.tdump</b> format:&nbsp; <b>Visual VM </b><br /><br />2.<b> hs_err_pid.log</b> format : We need to use Command line tools comes free with JDK.<br />a. <b>jstack </b>-&gt; Prints Stack Trace<br />b. <b>jmap </b>-&gt; Heap memory details<br />And most of the time manually reading as this is text format. We can use filtering. There are also small parser, mainly shell scripts for different filters. Here is one <a href="https://github.com/digulla/Java-hs_err_pid-List-Library-Versions" target="_blank">example</a>.<br /><br /></div><div dir="ltr" style="text-align: center;" trbidi="on"><span style="font-size: large;">GC Log </span><span style="font-size: large;">Analysis</span><span style="font-size: large;">&nbsp;</span><span style="font-size: large;">: </span></div><div dir="ltr" style="text-align: center;" trbidi="on"><span style="font-size: large;"><br /></span></div><div dir="ltr" style="text-align: left;" trbidi="on">As , there are different type of JVM implemented from Open JDK, GC log also have different format. Mostly commonly use IBM &amp; Oracle format.&nbsp; And in each JVM there are different type of GC logs but mostly they follow the general format. Which is text format. Some times , old IBM verbose GC might not be compatible for latest openJVM or Oracle JVM generated GC. How to generate log, I will go details in separate blog.<br /><b><br /></b><b>For Oracle(default : Solaris JVM format)&nbsp; &amp; IBM Verbose GC log reading :</b><br /><br />1.&nbsp; <b>GCMV</b>( Garbage collector Memory Visualizer) standalone or GCMV Eclipse Plugins , comes with ISA</div><div class="separator" dir="ltr" style="clear: both; text-align: center;" trbidi="on"><a href="http://2.bp.blogspot.com/-QVCOQPQx9ls/Ve3hb5O2RnI/AAAAAAAABiA/3flCWMvUMCI/s1600/gcmv.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="217" src="http://2.bp.blogspot.com/-QVCOQPQx9ls/Ve3hb5O2RnI/AAAAAAAABiA/3flCWMvUMCI/s320/gcmv.jpg" width="320" /></a></div><div dir="ltr" style="text-align: left;" trbidi="on"><br /><br />2. <b>PMAT </b>(IBM Pattern Modeling Tool) : Multiple GC log together, comes with ISA<br /></div><div class="separator" dir="ltr" style="clear: both; text-align: center;" trbidi="on"><a href="http://4.bp.blogspot.com/-C1pPEw3LCps/Ve3g7JPwmDI/AAAAAAAABh4/SKwAqeXkexM/s1600/PMTA.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="246" src="http://4.bp.blogspot.com/-C1pPEw3LCps/Ve3g7JPwmDI/AAAAAAAABh4/SKwAqeXkexM/s320/PMTA.jpg" width="320" /></a></div><div dir="ltr" style="text-align: left;" trbidi="on"><br />3. One of good 3rd Party Log viewers : <b><a href="https://github.com/chewiebug/gcviewer/wiki" target="_blank">GCViewer</a>&nbsp;</b>,&nbsp; Supported formats :<br />Sun JDK 1.4/1.5 ( -Xloggc:&lt;file&gt; [-XX:+PrintGCDetails] )<br />Sun JDK 1.2.2/1.3.1/1.4 (-verbose:gc )<br />IBM JDK 1.3.1/1.3.0/1.2.2 ( -verbose:gc)<br />IBM iSeries Classic JVM 1.4.2 (-verbose:gc)<br />HP-UX JDK 1.2/1.3/1.4.x ( -Xverbosegc)<br />BEA JRockit 1.4.2/1.5 (-verbose:memory)<br /><br />Some other GC log reader tools you may find in this <a href="http://fasterj.com/tools/gcloganalysers.shtml" target="_blank"><b>link. </b></a><br /><br /><b>Note : </b><br />1. For both VMs, we can use JProfiler, which is paid tool. If we use yourkit, different version of yourKit supports different version of JVMs, see archive page of yourkit for more details<br />2. For IBM tools, it is better to use IBM JVM. Either you can download JDK from IBM, or , you can download their development package with eclipse where JDK is present.<br />3. For IBM JVMs, usually an OOM will create a phd, a javaCore &amp; a trc file. In case you are storing GC logs, verbosegc log will be there.<br /><br />Please comment if you have any question. Thanks.. :) </div></div><div class="blogger-post-footer">Thanks for reading my personal blog. contact: shantonu_oxford@yahoo.com</div>